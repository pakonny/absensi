<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Absensi Siswa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">üìö Sistem Absensi Siswa</h1>
            <p class="text-gray-600">Kelola kehadiran siswa dengan mudah dan efisien</p>
        </div>

        <!-- Navigation -->
        <div class="flex justify-center mb-8">
            <div class="bg-white rounded-lg shadow-lg p-2 flex space-x-2">
                <button onclick="showSection('attendance')" id="btn-attendance" class="px-6 py-3 rounded-md font-medium transition-all bg-blue-600 text-white">
                    ‚úÖ Absensi
                </button>
                <button onclick="showSection('students')" id="btn-students" class="px-6 py-3 rounded-md font-medium transition-all text-gray-600 hover:bg-gray-100">
                    üë• Data Siswa
                </button>
                <button onclick="showSection('reports')" id="btn-reports" class="px-6 py-3 rounded-md font-medium transition-all text-gray-600 hover:bg-gray-100">
                    üìä Laporan
                </button>
            </div>
        </div>

        <!-- Attendance Section -->
        <div id="attendance-section" class="section fade-in">
            <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üìÖ Absensi Harian</h2>
                
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal</label>
                        <input type="date" id="attendance-date" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kelas</label>
                        <select id="class-filter" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Semua Kelas</option>
                            <option value="XII RPL 3">XII RPL 3</option>
                            <option value="XII RPL 4">XII RPL 4</option>
                            <option value="XII RPL 5">XII RPL 5</option>
                            <option value="XI RPL 4">XI RPL 4</option>
                            <option value="XI LOGISTIK">XI LOGISTIK</option>
                            <option value="X RPL 5">X RPL 5</option>
                        </select>
                    </div>
                </div>

                <div class="bg-gray-50 rounded-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">Daftar Siswa</h3>
                        <div class="flex space-x-2">
                            <button onclick="loadExistingAttendance()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors text-sm">
                                üìù Edit Absensi
                            </button>
                            <button onclick="clearAttendanceForm()" class="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors text-sm">
                                üîÑ Reset Form
                            </button>
                        </div>
                    </div>
                    
                    <div id="attendance-status" class="hidden mb-4 p-3 rounded-lg">
                        <!-- Status message will appear here -->
                    </div>
                    
                    <div id="attendance-list" class="space-y-3">
                        <!-- Attendance list will be populated here -->
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button onclick="saveAttendance()" id="save-btn" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                            üíæ Simpan Absensi
                        </button>
                        <button onclick="deleteAttendance()" id="delete-btn" class="hidden bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                            üóëÔ∏è Hapus Absensi
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Students Section -->
        <div id="students-section" class="section hidden">
            <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">üë• Data Siswa</h2>
                    <div class="flex space-x-3">
                        <button onclick="downloadTemplate()" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                            üì• Download Template
                        </button>
                        <button onclick="showUploadForm()" class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                            üì§ Upload Excel
                        </button>
                        <button onclick="showAddStudentForm()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                            ‚ûï Tambah Siswa
                        </button>
                    </div>
                </div>

                <!-- Upload Excel Form -->
                <div id="upload-excel-form" class="hidden bg-purple-50 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">üì§ Upload Data Siswa dari Excel</h3>
                    <div class="bg-white rounded-lg p-4 border-2 border-dashed border-purple-300 mb-4">
                        <div class="text-center">
                            <div class="mb-4">
                                <svg class="mx-auto h-12 w-12 text-purple-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </div>
                            <input type="file" id="excel-file" accept=".xlsx,.xls,.csv" class="hidden" onchange="handleFileSelect(event)">
                            <button onclick="document.getElementById('excel-file').click()" class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                                Pilih File Excel
                            </button>
                            <p class="text-sm text-gray-600 mt-2">Format: .xlsx, .xls, atau .csv</p>
                            <p class="text-xs text-gray-500 mt-1">Kolom: NIS, Nama, Kelas</p>
                        </div>
                    </div>
                    <div id="file-preview" class="hidden bg-white rounded-lg p-4 mb-4">
                        <h4 class="font-semibold text-gray-800 mb-2">Preview Data:</h4>
                        <div id="preview-content" class="text-sm text-gray-600"></div>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="uploadExcelData()" id="upload-btn" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors disabled:bg-gray-400" disabled>
                            ‚úÖ Upload Data
                        </button>
                        <button onclick="hideUploadForm()" class="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                            ‚ùå Batal
                        </button>
                    </div>
                </div>

                <!-- Add Student Form -->
                <div id="add-student-form" class="hidden bg-blue-50 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Tambah Siswa Baru</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <input type="text" id="student-name" placeholder="Nama Lengkap" class="px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="text" id="student-nis" placeholder="NIS" class="px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <select id="student-class" class="px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Pilih Kelas</option>
                            <option value="XII RPL 3">XII RPL 3</option>
                            <option value="XII RPL 4">XII RPL 4</option>
                            <option value="XII RPL 5">XII RPL 5</option>
                            <option value="XI RPL 4">XI RPL 4</option>
                            <option value="XI LOGISTIK">XI LOGISTIK</option>
                            <option value="X RPL 5">X RPL 5</option>
                        </select>
                    </div>
                    <div class="flex space-x-3 mt-4">
                        <button onclick="addStudent()" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                            ‚úÖ Simpan
                        </button>
                        <button onclick="hideAddStudentForm()" class="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                            ‚ùå Batal
                        </button>
                    </div>
                </div>

                <!-- Students List -->
                <div class="overflow-x-auto">
                    <table class="w-full table-auto">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">NIS</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Nama</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Kelas</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="students-table">
                            <!-- Students will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Reports Section -->
        <div id="reports-section" class="section hidden">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üìä Laporan Kehadiran</h2>
                
                <div class="grid md:grid-cols-3 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Dari Tanggal</label>
                        <input type="date" id="report-start-date" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Sampai Tanggal</label>
                        <input type="date" id="report-end-date" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kelas</label>
                        <select id="report-class-filter" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Semua Kelas</option>
                            <option value="XII RPL 3">XII RPL 3</option>
                            <option value="XII RPL 4">XII RPL 4</option>
                            <option value="XII RPL 5">XII RPL 5</option>
                            <option value="XI RPL 4">XI RPL 4</option>
                            <option value="XI LOGISTIK">XI LOGISTIK</option>
                            <option value="X RPL 5">X RPL 5</option>
                        </select>
                    </div>
                </div>

                <button onclick="generateReport()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors mb-6">
                    üìà Generate Laporan
                </button>

                <div id="report-results" class="hidden">
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Hasil Laporan</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full table-auto">
                                <thead>
                                    <tr class="bg-gray-200">
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Nama</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Kelas</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Hadir</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Sakit</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Izin</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Alpha</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Persentase</th>
                                    </tr>
                                </thead>
                                <tbody id="report-table">
                                    <!-- Report data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let students = JSON.parse(localStorage.getItem('students')) || [
            // X RPL 5 Students
            { id: 1, nis: '27306/2252.63', name: 'Muhammad Rafid Haidar S.', class: 'X RPL 5' },
            { id: 2, nis: '27307/2253.63', name: 'Muhammad Ulul Al-bab Isommudin', class: 'X RPL 5' },
            { id: 3, nis: '27308/2254.63', name: 'Mutiara Bunga Zaskia', class: 'X RPL 5' },
            { id: 4, nis: '27309/2255.63', name: 'Najwa Latisya Abbad', class: 'X RPL 5' },
            { id: 5, nis: '27310/2256.63', name: 'Nazil Habib Nur Rachman', class: 'X RPL 5' },
            { id: 6, nis: '27311/2257.63', name: 'Nikitha Rifqah Fatih', class: 'X RPL 5' },
            { id: 7, nis: '27312/2258.63', name: 'Nila Novelita Hapsari', class: 'X RPL 5' },
            { id: 8, nis: '27313/2259.63', name: 'Nizal Habib Nur Rachman', class: 'X RPL 5' },
            { id: 9, nis: '27314/2260.63', name: 'Noval Joeliawan', class: 'X RPL 5' },
            { id: 10, nis: '27315/2261.63', name: 'Novaria Zahra Zalianti', class: 'X RPL 5' },
            { id: 11, nis: '27316/2262.63', name: 'Nurul Fadilah', class: 'X RPL 5' },
            { id: 12, nis: '27317/2263.63', name: 'Nurul Syaidahtur Rohmah', class: 'X RPL 5' },
            { id: 13, nis: '27318/2264.63', name: 'Olan Talitha Fahriyah Assa', class: 'X RPL 5' },
            { id: 14, nis: '27319/2265.63', name: 'Preneta Pricylla Permata Ibadani', class: 'X RPL 5' },
            { id: 15, nis: '27320/2266.63', name: 'Rachmat Bagus Ramadhan', class: 'X RPL 5' },
            { id: 16, nis: '27321/2267.63', name: 'Rangga Dwy Ramadhan', class: 'X RPL 5' },
            { id: 17, nis: '27322/2268.63', name: 'Rarah Ulaikah', class: 'X RPL 5' },
            { id: 18, nis: '27323/2269.63', name: 'Rasya Shadiqul Amin', class: 'X RPL 5' },
            { id: 19, nis: '27324/2270.63', name: 'Rayya Adyatma Ramadhan', class: 'X RPL 5' },
            { id: 20, nis: '27325/2271.63', name: 'Reihansyah Suryo Al-Faruq', class: 'X RPL 5' },
            { id: 21, nis: '27326/2272.63', name: 'Reyhan Anggareza', class: 'X RPL 5' },
            { id: 22, nis: '27327/2273.63', name: 'Rifky Aditya Herba', class: 'X RPL 5' },
            { id: 23, nis: '27328/2274.63', name: 'Riska Rahmawati Putri Muda\'i', class: 'X RPL 5' },
            { id: 24, nis: '27329/2275.63', name: 'Ruly Amalia Anjani', class: 'X RPL 5' },
            { id: 25, nis: '27330/2276.63', name: 'Salma Sania Wulandari', class: 'X RPL 5' },
            { id: 26, nis: '27331/2277.63', name: 'Salsabila Rizkyana Wijaya', class: 'X RPL 5' },
            { id: 27, nis: '27332/2278.63', name: 'Salsabila Roihatul Habibah', class: 'X RPL 5' },
            { id: 28, nis: '27333/2279.63', name: 'Sandy Mayesa', class: 'X RPL 5' },
            { id: 29, nis: '27334/2280.63', name: 'Savira Zauharotun Naswa', class: 'X RPL 5' },
            { id: 30, nis: '27335/2281.63', name: 'Sekar Pudak Wangi', class: 'X RPL 5' },
            { id: 31, nis: '27336/2282.63', name: 'Shesa Mutiara Thirza', class: 'X RPL 5' },
            { id: 32, nis: '27337/2283.63', name: 'Sheta Dwi Dharyanti', class: 'X RPL 5' },
            { id: 33, nis: '27338/2284.63', name: 'Shinta Aurellia', class: 'X RPL 5' },
            { id: 34, nis: '27339/2285.63', name: 'Siti Alsya Oktavia Putri', class: 'X RPL 5' },
            { id: 35, nis: '27340/2286.63', name: 'Syulga Al Faruq Mundi', class: 'X RPL 5' },
            { id: 36, nis: '27341/2287.63', name: 'Tiara Maulidya Kirani', class: 'X RPL 5' },
            { id: 37, nis: '27342/2288.63', name: 'Vicho Fatchur Rizki', class: 'X RPL 5' },
            { id: 38, nis: '27343/2289.63', name: 'Vitalia Ayu Marisa', class: 'X RPL 5' },
            { id: 39, nis: '27344/2290.63', name: 'Wulan Fahma Arie Anggraini', class: 'X RPL 5' },
            { id: 40, nis: '27345/2291.63', name: 'Yahya Zaky Setiawan', class: 'X RPL 5' },
            { id: 41, nis: '27346/2292.63', name: 'Zevanya Gladys Vlorencia', class: 'X RPL 5' },
            
            // XII RPL 3 Students
            { id: 42, nis: '25465/1800.63', name: 'Ishlah Febriansyah Pangestu', class: 'XII RPL 3' },
            { id: 43, nis: '25467/1802.63', name: 'Jihan Sa\'idah Quthrotun Nada', class: 'XII RPL 3' },
            { id: 44, nis: '25468/1803.63', name: 'Karina Aulia Wijayanti', class: 'XII RPL 3' },
            { id: 45, nis: '25469/1804.63', name: 'Keisya Nadya Az Zahra', class: 'XII RPL 3' },
            { id: 46, nis: '25470/1805.63', name: 'Latifatun Nadya Sofhwah', class: 'XII RPL 3' },
            { id: 47, nis: '25471/1806.63', name: 'Laura Valentina Christin', class: 'XII RPL 3' },
            { id: 48, nis: '25472/1807.63', name: 'Lilis Bunga Lestari', class: 'XII RPL 3' },
            { id: 49, nis: '25474/1809.63', name: 'Maria Aprillia Kolo', class: 'XII RPL 3' },
            { id: 50, nis: '25475/1810.63', name: 'Maria Nona Keyla Effendi', class: 'XII RPL 3' },
            { id: 51, nis: '25476/1811.63', name: 'Marsella Nur Imamah', class: 'XII RPL 3' },
            { id: 52, nis: '25477/1812.63', name: 'Maulana Sadham Prakoso', class: 'XII RPL 3' },
            { id: 53, nis: '25478/1813.63', name: 'Miftachul \'Ilmiyyah', class: 'XII RPL 3' },
            { id: 54, nis: '25479/1814.63', name: 'Moch Laudin Putra Permata', class: 'XII RPL 3' },
            { id: 55, nis: '25480/1815.63', name: 'Moch. Kevin Dwi Syaputra', class: 'XII RPL 3' },
            { id: 56, nis: '25481/1816.63', name: 'Mochamad Alfath Rizqi Albaihaqi', class: 'XII RPL 3' },
            { id: 57, nis: '25482/1817.63', name: 'Mochammad Abdila Tulus Wiranata', class: 'XII RPL 3' },
            { id: 58, nis: '25483/1818.63', name: 'Mochammad Falyanzuhril Fuat', class: 'XII RPL 3' },
            { id: 59, nis: '25485/1820.63', name: 'Mochammad Krisna Mehisa', class: 'XII RPL 3' },
            { id: 60, nis: '25486/1821.63', name: 'Mochammad Nasirudin', class: 'XII RPL 3' },
            { id: 61, nis: '25487/1822.63', name: 'Mohammad Barikh Zidane', class: 'XII RPL 3' },
            { id: 62, nis: '25489/1824.63', name: 'Muhamad Bagus Satria', class: 'XII RPL 3' },
            { id: 63, nis: '25490/1825.63', name: 'Muhamad Femas Rifiansyah', class: 'XII RPL 3' },
            { id: 64, nis: '25491/1826.63', name: 'Muhammad Alfan Rizqillah Arif', class: 'XII RPL 3' },
            { id: 65, nis: '25492/1827.63', name: 'Muhammad Azzam Arvanda Saputra', class: 'XII RPL 3' },
            { id: 66, nis: '25494/1829.63', name: 'Muhammad Faiz Aditya', class: 'XII RPL 3' },
            { id: 67, nis: '25495/1830.63', name: 'Muhammad Kevin Fabianto', class: 'XII RPL 3' },
            { id: 68, nis: '25496/1831.63', name: 'Muhammad Nazril Maulana', class: 'XII RPL 3' },
            { id: 69, nis: '25498/1833.63', name: 'Muhammad Rajib Auliya\'', class: 'XII RPL 3' },
            { id: 70, nis: '25500/1835.63', name: 'Muhammad Ridho Nur Hariyanto', class: 'XII RPL 3' },
            { id: 71, nis: '25507/1842.63', name: 'Nadia Nia Agustin', class: 'XII RPL 3' },
            { id: 72, nis: '25509/1844.63', name: 'Naila Yustria Cahya Bintari', class: 'XII RPL 3' },
            { id: 73, nis: '25510/1845.63', name: 'Nayla Septyanti Nuryanto', class: 'XII RPL 3' },
            { id: 74, nis: '25511/1846.63', name: 'Nazaul Khotimah', class: 'XII RPL 3' },
            { id: 75, nis: '25512/1847.63', name: 'Nazwa Zakila Salsabila', class: 'XII RPL 3' },
            { id: 76, nis: '25515/1850.63', name: 'Novelia Ayu Anggraini', class: 'XII RPL 3' },
            { id: 77, nis: '25516/1851.63', name: 'Nur Khumairoh', class: 'XII RPL 3' },
            { id: 78, nis: '25517/1852.63', name: 'Nur Natasya Anabella', class: 'XII RPL 3' },
            { id: 79, nis: '25520/1855.63', name: 'Rachel Dian Anandhitya', class: 'XII RPL 3' },
            { id: 80, nis: '25525/1860.63', name: 'Rahmat Govin Tarwiyan', class: 'XII RPL 3' },
            { id: 81, nis: '25527/1862.63', name: 'Rama Teuku Ardiansyah', class: 'XII RPL 3' },
            { id: 82, nis: '25528/1863.63', name: 'Randhika Arya Firli Firansyah', class: 'XII RPL 3' },
            { id: 83, nis: '25529/1864.63', name: 'Rapthandra Chava Novic', class: 'XII RPL 3' },
            { id: 84, nis: '25530/1865.63', name: 'Reifan Bintang Pradana', class: 'XII RPL 3' },
            { id: 85, nis: '25531/1866.63', name: 'Rendy Ferdiansyah', class: 'XII RPL 3' },
            { id: 86, nis: '25532/1867.63', name: 'Reni Dwi Lavenia', class: 'XII RPL 3' },
            { id: 87, nis: '25533/1868.63', name: 'Reno Widi Prastyo', class: 'XII RPL 3' },
            { id: 88, nis: '25534/1869.63', name: 'Rino Ardiansyah', class: 'XII RPL 3' },
            { id: 89, nis: '25535/1870.63', name: 'Rizky Naila Dwi Agustin Siky', class: 'XII RPL 3' },
            { id: 90, nis: '25536/1871.63', name: 'Rotul Rutsya', class: 'XII RPL 3' },
            { id: 91, nis: '25537/1872.63', name: 'Royhan Febrino Aray', class: 'XII RPL 3' },
            { id: 92, nis: '25538/1873.63', name: 'Safira Mei Syaroh', class: 'XII RPL 3' },
            { id: 93, nis: '25541/1876.63', name: 'Salsabila Ramadhani', class: 'XII RPL 3' },
            { id: 94, nis: '25542/1877.63', name: 'Salwa Nur Aghnia', class: 'XII RPL 3' },
            { id: 95, nis: '25543/1878.63', name: 'Satrio Putra Prasetyo', class: 'XII RPL 3' },
            { id: 96, nis: '25544/1879.63', name: 'Seira Septia Katalyna', class: 'XII RPL 3' },
            { id: 97, nis: '25545/1880.63', name: 'Shella Arifatun nisa\'', class: 'XII RPL 3' },
            { id: 98, nis: '25546/1881.63', name: 'Shelly Zulfarindah', class: 'XII RPL 3' },
            { id: 99, nis: '25547/1882.63', name: 'Shifa Nur Aulia', class: 'XII RPL 3' },
            { id: 100, nis: '25548/1883.63', name: 'Shofiyah \'Izzatul Mukarromah As-Sya\'Baniyah', class: 'XII RPL 3' },
            { id: 101, nis: '25549/1884.63', name: 'Siska Ainun Karnita', class: 'XII RPL 3' },
            { id: 102, nis: '25550/1885.63', name: 'Stevani Dwi Permata Sari', class: 'XII RPL 3' },
            { id: 103, nis: '25551/1886.63', name: 'Syafiq Fattah Abdillah', class: 'XII RPL 3' },
            { id: 104, nis: '25552/1887.63', name: 'Sazwa Rifahtul Amanda', class: 'XII RPL 3' },
            { id: 105, nis: '25553/1888.63', name: 'Tegar Ahmadna Thoriqul Abidin', class: 'XII RPL 3' },
            { id: 106, nis: '25555/1890.63', name: 'Vera Wulandari', class: 'XII RPL 3' },
            { id: 107, nis: '25556/1891.63', name: 'Vino Dwi Sebastian', class: 'XII RPL 3' },
            { id: 108, nis: '25557/1892.63', name: 'Vivi Amelia Listy', class: 'XII RPL 3' },
            { id: 109, nis: '25558/1893.63', name: 'Yarkana Fasha Yoga Efendi', class: 'XII RPL 3' },
            { id: 110, nis: '25559/1894.63', name: 'Yukholifa Nikmatul Mubarokah', class: 'XII RPL 3' },
            { id: 111, nis: '25560/1895.63', name: 'Yusika Zahra', class: 'XII RPL 3' },
            { id: 112, nis: '25561/1896.63', name: 'Yusuf Aditya Susanto Putra', class: 'XII RPL 3' },
            { id: 113, nis: '25562/1897.63', name: 'Zaskya Bunga Nur Afifah', class: 'XII RPL 3' },
            { id: 114, nis: '25563/1898.63', name: 'Zhara Habbibah Setya Anasyarie', class: 'XII RPL 3' },
            { id: 115, nis: '25564/1899.63', name: 'Zona Putra Pratama', class: 'XII RPL 3' },
            { id: 116, nis: '25565/1900.63', name: 'Muhammad Afidin', class: 'XII RPL 3' },
            
            // XII RPL 4 Students
            { id: 117, nis: '25525/1860.63', name: 'Rahmat Govin Tarwiyan', class: 'XII RPL 4' },
            { id: 118, nis: '25527/1862.63', name: 'Rama Teuku Ardiansyah', class: 'XII RPL 4' },
            { id: 119, nis: '25528/1863.63', name: 'Randhika Arya Firli Firansyah', class: 'XII RPL 4' },
            { id: 120, nis: '25529/1864.63', name: 'Rapthandra Chava Novic', class: 'XII RPL 4' },
            { id: 121, nis: '25530/1865.63', name: 'Reifan Bintang Pradana', class: 'XII RPL 4' },
            { id: 122, nis: '25531/1866.63', name: 'Rendy Ferdiansyah', class: 'XII RPL 4' },
            { id: 123, nis: '25532/1867.63', name: 'Reni Dwi Lavenia', class: 'XII RPL 4' },
            { id: 124, nis: '25533/1868.63', name: 'Reno Widi Prastyo', class: 'XII RPL 4' },
            { id: 125, nis: '25534/1869.63', name: 'Rino Ardiansyah', class: 'XII RPL 4' },
            { id: 126, nis: '25535/1870.63', name: 'Rizky Naila Dwi Agustin Siky', class: 'XII RPL 4' },
            { id: 127, nis: '25536/1871.63', name: 'Rotul Rutsya', class: 'XII RPL 4' },
            { id: 128, nis: '25537/1872.63', name: 'Royhan Febrino Aray', class: 'XII RPL 4' },
            { id: 129, nis: '25538/1873.63', name: 'Safira Mei Syaroh', class: 'XII RPL 4' },
            { id: 130, nis: '25541/1876.63', name: 'Salsabila Ramadhani', class: 'XII RPL 4' },
            { id: 131, nis: '25542/1877.63', name: 'Salwa Nur Aghnia', class: 'XII RPL 4' },
            { id: 132, nis: '25543/1878.63', name: 'Satrio Putra Prasetyo', class: 'XII RPL 4' },
            { id: 133, nis: '25544/1879.63', name: 'Seira Septia Katalyna', class: 'XII RPL 4' },
            { id: 134, nis: '25545/1880.63', name: 'Shella Arifatun nisa\'', class: 'XII RPL 4' },
            { id: 135, nis: '25546/1881.63', name: 'Shelly Zulfarindah', class: 'XII RPL 4' },
            { id: 136, nis: '25547/1882.63', name: 'Shifa Nur Aulia', class: 'XII RPL 4' },
            { id: 137, nis: '25548/1883.63', name: 'Shofiyah \'Izzatul Mukarromah As-Sya\'Baniyah', class: 'XII RPL 4' },
            { id: 138, nis: '25549/1884.63', name: 'Siska Ainun Karnita', class: 'XII RPL 4' },
            { id: 139, nis: '25550/1885.63', name: 'Stevani Dwi Permata Sari', class: 'XII RPL 4' },
            { id: 140, nis: '25551/1886.63', name: 'Syafiq Fattah Abdillah', class: 'XII RPL 4' },
            { id: 141, nis: '25552/1887.63', name: 'Sazwa Rifahtul Amanda', class: 'XII RPL 4' },
            { id: 142, nis: '25553/1888.63', name: 'Tegar Ahmadna Thoriqul Abidin', class: 'XII RPL 4' },
            { id: 143, nis: '25555/1890.63', name: 'Vera Wulandari', class: 'XII RPL 4' },
            { id: 144, nis: '25556/1891.63', name: 'Vino Dwi Sebastian', class: 'XII RPL 4' },
            { id: 145, nis: '25557/1892.63', name: 'Vivi Amelia Listy', class: 'XII RPL 4' },
            { id: 146, nis: '25558/1893.63', name: 'Yarkana Fasha Yoga Efendi', class: 'XII RPL 4' },
            { id: 147, nis: '25559/1894.63', name: 'Yukholifa Nikmatul Mubarokah', class: 'XII RPL 4' },
            { id: 148, nis: '25560/1895.63', name: 'Yusika Zahra', class: 'XII RPL 4' },
            { id: 149, nis: '25561/1896.63', name: 'Yusuf Aditya Susanto Putra', class: 'XII RPL 4' },
            { id: 150, nis: '25562/1897.63', name: 'Zaskya Bunga Nur Afifah', class: 'XII RPL 4' },
            { id: 151, nis: '25563/1898.63', name: 'Zhara Habbibah Setya Anasyarie', class: 'XII RPL 4' },
            { id: 152, nis: '25564/1899.63', name: 'Zona Putra Pratama', class: 'XII RPL 4' },
            { id: 153, nis: '25565/1900.63', name: 'Muhammad Afidin', class: 'XII RPL 4' },
            
            // XII RPL 5 Students
            { id: 154, nis: '25416/1751.63', name: 'Afwan Ardiansyah', class: 'XII RPL 5' },
            { id: 155, nis: '25417/1752.63', name: 'Akbar Zain Mirza Maulana', class: 'XII RPL 5' },
            { id: 156, nis: '25423/1758.63', name: 'Anang Makruf', class: 'XII RPL 5' },
            { id: 157, nis: '25427/1762.63', name: 'Asyiva Syavina Indriani', class: 'XII RPL 5' },
            { id: 158, nis: '25428/1763.63', name: 'Atha Al Hammam', class: 'XII RPL 5' },
            { id: 159, nis: '25430/1765.63', name: 'Ayunda Syifa Ashari', class: 'XII RPL 5' },
            { id: 160, nis: '25434/1769.63', name: 'Bilqis Nadisya Putri', class: 'XII RPL 5' },
            { id: 161, nis: '25440/1775.63', name: 'Destanto Dwi Anggoro', class: 'XII RPL 5' },
            { id: 162, nis: '25443/1778.63', name: 'Dimas Yusuf Budianto', class: 'XII RPL 5' },
            { id: 163, nis: '25451/1786.63', name: 'Eka Yuliana', class: 'XII RPL 5' },
            { id: 164, nis: '25454/1789.63', name: 'Farah Nirmala Putri', class: 'XII RPL 5' },
            { id: 165, nis: '25458/1793.63', name: 'Genta Dhini Isyak Azzahra', class: 'XII RPL 5' },
            { id: 166, nis: '25460/1795.63', name: 'Hikmatul Fauziyah', class: 'XII RPL 5' },
            { id: 167, nis: '25466/1801.63', name: 'Jevon Javier Grostin', class: 'XII RPL 5' },
            { id: 168, nis: '25473/1808.63', name: 'M. Thoriq Isham Al Bani', class: 'XII RPL 5' },
            { id: 169, nis: '25484/1819.63', name: 'Mochammad Kokoh Alfarrel Oktavimansyah', class: 'XII RPL 5' },
            { id: 170, nis: '25493/1828.63', name: 'Muhammad Fadli Farodis', class: 'XII RPL 5' },
            { id: 171, nis: '25497/1832.63', name: 'Muhammad Rafly Mardiansyah', class: 'XII RPL 5' },
            { id: 172, nis: '25499/1834.63', name: 'Muhammad Reno Anastasya', class: 'XII RPL 5' },
            { id: 173, nis: '25501/1836.63', name: 'Muhammad Riswa Putra Pratama', class: 'XII RPL 5' },
            { id: 174, nis: '25502/1837.63', name: 'Muhammad Rizky Afrizal Julkarnain', class: 'XII RPL 5' },
            { id: 175, nis: '25503/1838.63', name: 'Muhammad Shirothaqil Ilham Akbar', class: 'XII RPL 5' },
            { id: 176, nis: '25504/1839.63', name: 'Mu\'min Jaya Laksono', class: 'XII RPL 5' },
            { id: 177, nis: '25505/1840.63', name: 'Nabil Putra Aditya', class: 'XII RPL 5' },
            { id: 178, nis: '25513/1848.63', name: 'Nouvaldo Rizky Putra Adinata', class: 'XII RPL 5' },
            { id: 179, nis: '25518/1853.63', name: 'Pasha Dwi Ramadhan Putra', class: 'XII RPL 5' },
            { id: 180, nis: '25519/1854.63', name: 'Putra Nazaryanto', class: 'XII RPL 5' },
            { id: 181, nis: '25521/1856.63', name: 'Radina Maulani', class: 'XII RPL 5' },
            { id: 182, nis: '25522/1857.63', name: 'Rafi\' Ahmad Fairuz', class: 'XII RPL 5' },
            { id: 183, nis: '25523/1858.63', name: 'Ragil Ridwansyah Zulkarnain', class: 'XII RPL 5' },
            { id: 184, nis: '25539/1874.63', name: 'Saila Lailatul Sholikha', class: 'XII RPL 5' },
            { id: 185, nis: '25540/1875.63', name: 'Salsabila Putri Firdaus', class: 'XII RPL 5' },
            { id: 186, nis: '25554/1889.63', name: 'Valencia Jessica Anggraini', class: 'XII RPL 5' },
            
            // XI RPL 4 Students
            { id: 187, nis: '26399/2050.63', name: 'Naura Citra Nathania', class: 'XI RPL 4' },
            { id: 188, nis: '26403/2054.63', name: 'Nurul Iftita Nevinda', class: 'XI RPL 4' },
            { id: 189, nis: '26404/2055.63', name: 'Nurul Uswatun Khasanah', class: 'XI RPL 4' },
            { id: 190, nis: '26405/2056.63', name: 'Oktivianda', class: 'XI RPL 4' },
            { id: 191, nis: '26406/2057.63', name: 'Oky Wahyu Firmansyah', class: 'XI RPL 4' },
            { id: 192, nis: '26407/2058.63', name: 'Panji Farhan  indraswaya', class: 'XI RPL 4' },
            { id: 193, nis: '26408/2059.63', name: 'Pasya Ramadhani Putra Sagita', class: 'XI RPL 4' },
            { id: 194, nis: '26409/2060.63', name: 'Prisca Putri Anastasya', class: 'XI RPL 4' },
            { id: 195, nis: '26410/2061.63', name: 'Putri Novitasari', class: 'XI RPL 4' },
            { id: 196, nis: '26411/2062.63', name: 'Rachmad Budi Ari Wicaksono', class: 'XI RPL 4' },
            { id: 197, nis: '26412/2063.63', name: 'Raditya Gusti Daniswara', class: 'XI RPL 4' },
            { id: 198, nis: '26413/2064.63', name: 'Raffa Brillian Putra Widianto', class: 'XI RPL 4' },
            { id: 199, nis: '26414/2065.63', name: 'Rahmad Ikhsan Maulana', class: 'XI RPL 4' },
            { id: 200, nis: '26415/2066.63', name: 'Rahmatullah Sastra Ardiansyah', class: 'XI RPL 4' },
            { id: 201, nis: '26417/2068.63', name: 'Rangga Risky Pratama', class: 'XI RPL 4' },
            { id: 202, nis: '26418/2069.63', name: 'Rendi Aldiano Eka Saputra', class: 'XI RPL 4' },
            { id: 203, nis: '26419/2070.63', name: 'Revani Dwi Agustin', class: 'XI RPL 4' },
            { id: 204, nis: '26420/2071.63', name: 'Revina Dwi Agustin ', class: 'XI RPL 4' },
            { id: 205, nis: '26421/2072.63', name: 'Ricky Valentino Wenas', class: 'XI RPL 4' },
            { id: 206, nis: '26422/2073.63', name: 'Salsa Permatasari', class: 'XI RPL 4' },
            { id: 207, nis: '26423/2074.63', name: 'Sekar Ayu Wulandari', class: 'XI RPL 4' },
            { id: 208, nis: '26424/2075.63', name: 'Selfi Herdiyah Anggreini', class: 'XI RPL 4' },
            { id: 209, nis: '26425/2076.63', name: 'Sevi Rahmawati', class: 'XI RPL 4' },
            { id: 210, nis: '26426/2077.63', name: 'Silvia Adistiana', class: 'XI RPL 4' },
            { id: 211, nis: '26427/2078.63', name: 'Sintya Fitri Adevia', class: 'XI RPL 4' },
            { id: 212, nis: '26428/2079.63', name: 'Siti Laraswati', class: 'XI RPL 4' },
            { id: 213, nis: '26429/2080.63', name: 'Syeto Pujiarto', class: 'XI RPL 4' },
            { id: 214, nis: '26430/2081.63', name: 'Syifa Hafizah Azaria', class: 'XI RPL 4' },
            { id: 215, nis: '26431/2082.63', name: 'Valentina Gebi Aurora', class: 'XI RPL 4' },
            { id: 216, nis: '26432/2083.63', name: 'Vika Uswatul Khoirunisa', class: 'XI RPL 4' },
            { id: 217, nis: '26434/2085.63', name: 'Virginia Syakeyla', class: 'XI RPL 4' },
            { id: 218, nis: '26435/2086.63', name: 'Vivia Maulidia', class: 'XI RPL 4' },
            { id: 219, nis: '26436/2087.63', name: 'Wahyu Yeri Ibrahimovic', class: 'XI RPL 4' },
            { id: 220, nis: '26437/2088.63', name: 'Wulan Rizki', class: 'XI RPL 4' },
            { id: 221, nis: '26439/2090.63', name: 'Yehezkiel David Christian Semedi', class: 'XI RPL 4' },
            { id: 222, nis: '26440/2091.63', name: 'Yulanda Jihan Amelia', class: 'XI RPL 4' },
            { id: 223, nis: '26441/2092.63', name: 'Zahrotul Jannah', class: 'XI RPL 4' },
            { id: 224, nis: '26442/2093.63', name: 'Angga Prasetya', class: 'XI RPL 4' },
            
            // XI LOGISTIK Students
            { id: 225, nis: '25961/78.26', name: 'Agung Joko Tirto', class: 'XI LOGISTIK' },
            { id: 226, nis: '25962/79.26', name: 'Agung Ramadhan', class: 'XI LOGISTIK' },
            { id: 227, nis: '25963/80.26', name: 'Ainnur Aprillia', class: 'XI LOGISTIK' },
            { id: 228, nis: '25964/81.26', name: 'Alam Nasrudin', class: 'XI LOGISTIK' },
            { id: 229, nis: '25965/82.26', name: 'Alichia Rachmawati', class: 'XI LOGISTIK' },
            { id: 230, nis: '25966/83.26', name: 'Amirah Arrumaisha Putri Dwipa', class: 'XI LOGISTIK' },
            { id: 231, nis: '25967/84.26', name: 'Ananda Nuraffanza Islami', class: 'XI LOGISTIK' },
            { id: 232, nis: '25968/85.26', name: 'Anggita Dwi Oktavia', class: 'XI LOGISTIK' },
            { id: 233, nis: '25969/86.26', name: 'Arinda Dwi Handayani', class: 'XI LOGISTIK' },
            { id: 234, nis: '25970/87.26', name: 'Cahyani Anggun Larasati', class: 'XI LOGISTIK' },
            { id: 235, nis: '25972/89.26', name: 'Cresy Rismono', class: 'XI LOGISTIK' },
            { id: 236, nis: '25973/90.26', name: 'Daffa Arsyad Faeza', class: 'XI LOGISTIK' },
            { id: 237, nis: '25974/91.26', name: 'Della Dwi Puspita Sari', class: 'XI LOGISTIK' },
            { id: 238, nis: '25975/92.26', name: 'Denis Nur Azizah', class: 'XI LOGISTIK' },
            { id: 239, nis: '25976/93.26', name: 'Diandra Nawa Sukeisya', class: 'XI LOGISTIK' },
            { id: 240, nis: '25977/94.26', name: 'Fabian Ibrahimovic Rizki Suryo Adi', class: 'XI LOGISTIK' },
            { id: 241, nis: '25978/95.26', name: 'Fitri Qurota A\'yuni', class: 'XI LOGISTIK' },
            { id: 242, nis: '25979/96.26', name: 'Fitria Dwi Ardita', class: 'XI LOGISTIK' },
            { id: 243, nis: '25980/97.26', name: 'Helga Nis Rinasari', class: 'XI LOGISTIK' },
            { id: 244, nis: '25981/98.26', name: 'Imroatus Sa\'adah', class: 'XI LOGISTIK' },
            { id: 245, nis: '25982/99.26', name: 'Indah Nur Aini Rosidah', class: 'XI LOGISTIK' },
            { id: 246, nis: '25983/100.26', name: 'Khalimatus Sa\'diyah', class: 'XI LOGISTIK' },
            { id: 247, nis: '25984/101.26', name: 'Lailatul Salsabila Noviresta', class: 'XI LOGISTIK' },
            { id: 248, nis: '25985/102.26', name: 'Melinda Deviana Putri', class: 'XI LOGISTIK' },
            { id: 249, nis: '25986/103.26', name: 'Merry Khusmadwiyanti', class: 'XI LOGISTIK' },
            { id: 250, nis: '25987/104.26', name: 'Mochammad Andika Pratama', class: 'XI LOGISTIK' },
            { id: 251, nis: '25988/105.26', name: 'Muhamad Rizky', class: 'XI LOGISTIK' },
            { id: 252, nis: '25989/106.26', name: 'Muhammad Irsyad Ar Rahman', class: 'XI LOGISTIK' },
            { id: 253, nis: '25990/107.26', name: 'Nabyla Zahra Cayla', class: 'XI LOGISTIK' },
            { id: 254, nis: '25991/108.26', name: 'Nadine Aldawia Niken', class: 'XI LOGISTIK' },
            { id: 255, nis: '25992/109.26', name: 'Nazwa Dwi Meilia', class: 'XI LOGISTIK' },
            { id: 256, nis: '25993/110.26', name: 'Nur Aisya', class: 'XI LOGISTIK' },
            { id: 257, nis: '25994/111.26', name: 'Prisa Dea Mariska', class: 'XI LOGISTIK' },
            { id: 258, nis: '25995/112.26', name: 'Qinayah Aprilia Mukti', class: 'XI LOGISTIK' },
            { id: 259, nis: '25996/113.26', name: 'Rachmad Maulana Priambodo', class: 'XI LOGISTIK' },
            { id: 260, nis: '25997/114.26', name: 'Richa Amelia Pratiwi', class: 'XI LOGISTIK' },
            { id: 261, nis: '25998/115.26', name: 'Rihan Okta Febiansyah', class: 'XI LOGISTIK' },
            { id: 262, nis: '25999/116.26', name: 'Sabila Selvia Anggraini', class: 'XI LOGISTIK' },
            { id: 263, nis: '26000/117.26', name: 'Shella Melati Histi Faridah', class: 'XI LOGISTIK' },
            { id: 264, nis: '26001/118.26', name: 'Syu\'aa\'ul Ilma Nafia', class: 'XI LOGISTIK' },
            { id: 265, nis: '26002/119.26', name: 'Vania Rahma Putri Azzahra', class: 'XI LOGISTIK' },
            { id: 266, nis: '26003/120.26', name: 'Zabrina Rizky Aulia', class: 'XI LOGISTIK' }
        ];
        
        let attendance = JSON.parse(localStorage.getItem('attendance')) || {};
        let excelData = [];
        let isEditMode = false;
        let currentEditDate = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('attendance-date').value = new Date().toISOString().split('T')[0];
            document.getElementById('report-start-date').value = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            document.getElementById('report-end-date').value = new Date().toISOString().split('T')[0];
            
            renderStudentsTable();
            renderAttendanceList();
        });

        // Navigation
        function showSection(section) {
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById(section + '-section').classList.remove('hidden');
            document.getElementById(section + '-section').classList.add('fade-in');
            
            document.querySelectorAll('[id^="btn-"]').forEach(btn => {
                btn.className = 'px-6 py-3 rounded-md font-medium transition-all text-gray-600 hover:bg-gray-100';
            });
            document.getElementById('btn-' + section).className = 'px-6 py-3 rounded-md font-medium transition-all bg-blue-600 text-white';
            
            if (section === 'attendance') renderAttendanceList();
        }

        // Student management
        function showAddStudentForm() {
            document.getElementById('add-student-form').classList.remove('hidden');
        }

        function hideAddStudentForm() {
            document.getElementById('add-student-form').classList.add('hidden');
            document.getElementById('student-name').value = '';
            document.getElementById('student-nis').value = '';
            document.getElementById('student-class').value = '';
        }

        function showUploadForm() {
            document.getElementById('upload-excel-form').classList.remove('hidden');
            document.getElementById('add-student-form').classList.add('hidden');
        }

        function hideUploadForm() {
            document.getElementById('upload-excel-form').classList.add('hidden');
            document.getElementById('file-preview').classList.add('hidden');
            document.getElementById('excel-file').value = '';
            document.getElementById('upload-btn').disabled = true;
            excelData = [];
        }

        function addStudent() {
            const name = document.getElementById('student-name').value.trim();
            const nis = document.getElementById('student-nis').value.trim();
            const studentClass = document.getElementById('student-class').value;

            if (!name || !nis || !studentClass) {
                alert('Mohon lengkapi semua data siswa!');
                return;
            }

            if (students.find(s => s.nis === nis)) {
                alert('NIS sudah terdaftar!');
                return;
            }

            const newStudent = {
                id: Date.now(),
                nis: nis,
                name: name,
                class: studentClass
            };

            students.push(newStudent);
            localStorage.setItem('students', JSON.stringify(students));
            
            renderStudentsTable();
            renderAttendanceList();
            hideAddStudentForm();
            
            alert('Siswa berhasil ditambahkan!');
        }

        function deleteStudent(id) {
            if (confirm('Yakin ingin menghapus siswa ini?')) {
                students = students.filter(s => s.id !== id);
                localStorage.setItem('students', JSON.stringify(students));
                renderStudentsTable();
                renderAttendanceList();
            }
        }

        function renderStudentsTable() {
            const tbody = document.getElementById('students-table');
            tbody.innerHTML = students.map(student => `
                <tr class="border-b hover:bg-gray-50">
                    <td class="px-4 py-3 text-sm text-gray-900">${student.nis}</td>
                    <td class="px-4 py-3 text-sm text-gray-900">${student.name}</td>
                    <td class="px-4 py-3 text-sm text-gray-900">${student.class}</td>
                    <td class="px-4 py-3 text-sm">
                        <button onclick="deleteStudent(${student.id})" class="text-red-600 hover:text-red-800 font-medium">
                            üóëÔ∏è Hapus
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // Attendance management
        function renderAttendanceList() {
            const classFilter = document.getElementById('class-filter').value;
            const attendanceList = document.getElementById('attendance-list');
            
            if (classFilter) {
                // Show students from selected class only
                const filteredStudents = students.filter(s => s.class === classFilter);
                
                if (filteredStudents.length === 0) {
                    attendanceList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìö</div>
                            <p>Tidak ada siswa di kelas ${classFilter}</p>
                        </div>
                    `;
                    return;
                }
                
                attendanceList.innerHTML = `
                    <div class="mb-4 p-3 bg-blue-50 rounded-lg border-l-4 border-blue-400">
                        <h4 class="font-semibold text-blue-800">Kelas: ${classFilter}</h4>
                        <p class="text-sm text-blue-600">Total siswa: ${filteredStudents.length}</p>
                    </div>
                    ${filteredStudents.map(student => `
                        <div class="flex items-center justify-between bg-white p-4 rounded-lg border">
                            <div>
                                <div class="font-semibold text-gray-800">${student.name}</div>
                                <div class="text-sm text-gray-600">NIS: ${student.nis}</div>
                            </div>
                            <div class="flex items-center">
                                <select name="attendance-${student.id}" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm min-w-32">
                                    <option value="hadir" selected class="text-green-600">‚úÖ Hadir</option>
                                    <option value="sakit" class="text-yellow-600">ü§í Sakit</option>
                                    <option value="izin" class="text-blue-600">üìù Izin</option>
                                    <option value="alpha" class="text-red-600">‚ùå Alpha</option>
                                </select>
                            </div>
                        </div>
                    `).join('')}
                `;
            } else {
                // Show all students grouped by class
                const studentsByClass = {};
                students.forEach(student => {
                    if (!studentsByClass[student.class]) {
                        studentsByClass[student.class] = [];
                    }
                    studentsByClass[student.class].push(student);
                });
                
                if (Object.keys(studentsByClass).length === 0) {
                    attendanceList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üë•</div>
                            <p>Belum ada data siswa</p>
                            <p class="text-sm mt-2">Tambahkan siswa di menu "Data Siswa"</p>
                        </div>
                    `;
                    return;
                }
                
                let html = `
                    <div class="mb-4 p-3 bg-green-50 rounded-lg border-l-4 border-green-400">
                        <h4 class="font-semibold text-green-800">Semua Kelas</h4>
                        <p class="text-sm text-green-600">Total siswa: ${students.length} dari ${Object.keys(studentsByClass).length} kelas</p>
                    </div>
                `;
                
                // Sort classes
                const sortedClasses = Object.keys(studentsByClass).sort();
                
                sortedClasses.forEach(className => {
                    const classStudents = studentsByClass[className];
                    html += `
                        <div class="mb-6">
                            <div class="bg-gray-100 px-4 py-2 rounded-t-lg border-b-2 border-gray-300">
                                <h5 class="font-semibold text-gray-700">üìö ${className} (${classStudents.length} siswa)</h5>
                            </div>
                            <div class="space-y-2 bg-gray-50 p-3 rounded-b-lg">
                                ${classStudents.map(student => `
                                    <div class="flex items-center justify-between bg-white p-3 rounded-lg border">
                                        <div>
                                            <div class="font-semibold text-gray-800">${student.name}</div>
                                            <div class="text-sm text-gray-600">NIS: ${student.nis}</div>
                                        </div>
                                        <div class="flex items-center">
                                            <select name="attendance-${student.id}" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm min-w-32">
                                                <option value="hadir" selected class="text-green-600">‚úÖ Hadir</option>
                                                <option value="sakit" class="text-yellow-600">ü§í Sakit</option>
                                                <option value="izin" class="text-blue-600">üìù Izin</option>
                                                <option value="alpha" class="text-red-600">‚ùå Alpha</option>
                                            </select>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                });
                
                attendanceList.innerHTML = html;
            }
        }

        function saveAttendance() {
            const date = document.getElementById('attendance-date').value;
            if (!date) {
                alert('Pilih tanggal terlebih dahulu!');
                return;
            }

            const classFilter = document.getElementById('class-filter').value;
            const filteredStudents = classFilter ? 
                students.filter(s => s.class === classFilter) : students;

            const attendanceData = {};
            let hasAttendance = false;

            filteredStudents.forEach(student => {
                const selected = document.querySelector(`select[name="attendance-${student.id}"]`);
                if (selected && selected.value) {
                    attendanceData[student.id] = selected.value;
                    hasAttendance = true;
                }
            });

            if (!hasAttendance) {
                alert('Pilih status kehadiran untuk minimal satu siswa!');
                return;
            }

            if (!attendance[date]) attendance[date] = {};
            Object.assign(attendance[date], attendanceData);
            
            localStorage.setItem('attendance', JSON.stringify(attendance));
            
            const message = isEditMode ? 'Absensi berhasil diperbarui!' : 'Absensi berhasil disimpan!';
            alert(message);
            
            // Show success status
            showAttendanceStatus('success', message);
            
            // Update UI
            if (isEditMode) {
                currentEditDate = date;
                document.getElementById('delete-btn').classList.remove('hidden');
            }
            
            // Reset form - set all dropdowns back to "Hadir"
            document.querySelectorAll('select[name^="attendance-"]').forEach(select => select.value = 'hadir');
            
            // Exit edit mode
            isEditMode = false;
            updateSaveButtonText();
        }

        function loadExistingAttendance() {
            const date = document.getElementById('attendance-date').value;
            if (!date) {
                alert('Pilih tanggal terlebih dahulu!');
                return;
            }

            if (!attendance[date]) {
                alert('Tidak ada data absensi untuk tanggal ' + formatDate(date));
                return;
            }

            // Load existing attendance data
            const attendanceData = attendance[date];
            let loadedCount = 0;

            Object.keys(attendanceData).forEach(studentId => {
                const select = document.querySelector(`select[name="attendance-${studentId}"]`);
                if (select) {
                    select.value = attendanceData[studentId];
                    loadedCount++;
                }
            });

            if (loadedCount > 0) {
                isEditMode = true;
                currentEditDate = date;
                document.getElementById('delete-btn').classList.remove('hidden');
                updateSaveButtonText();
                
                showAttendanceStatus('info', `üìù Mode Edit: Data absensi ${formatDate(date)} berhasil dimuat (${loadedCount} siswa)`);
            } else {
                alert('Tidak dapat memuat data absensi!');
            }
        }

        function deleteAttendance() {
            const date = document.getElementById('attendance-date').value;
            if (!date || !attendance[date]) {
                alert('Tidak ada data absensi untuk dihapus!');
                return;
            }

            if (confirm(`Yakin ingin menghapus semua data absensi tanggal ${formatDate(date)}?\n\nTindakan ini tidak dapat dibatalkan!`)) {
                delete attendance[date];
                localStorage.setItem('attendance', JSON.stringify(attendance));
                
                // Reset form
                clearAttendanceForm();
                
                alert('Data absensi berhasil dihapus!');
                showAttendanceStatus('success', 'üóëÔ∏è Data absensi berhasil dihapus');
            }
        }

        function clearAttendanceForm() {
            // Reset all dropdowns to "Hadir"
            document.querySelectorAll('select[name^="attendance-"]').forEach(select => {
                select.value = 'hadir';
            });
            
            // Exit edit mode
            isEditMode = false;
            currentEditDate = null;
            document.getElementById('delete-btn').classList.add('hidden');
            updateSaveButtonText();
            
            // Hide status
            document.getElementById('attendance-status').classList.add('hidden');
            
            showAttendanceStatus('info', 'üîÑ Form absensi telah direset');
        }

        function updateSaveButtonText() {
            const saveBtn = document.getElementById('save-btn');
            if (isEditMode) {
                saveBtn.innerHTML = '‚úèÔ∏è Update Absensi';
                saveBtn.className = 'flex-1 bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors';
            } else {
                saveBtn.innerHTML = 'üíæ Simpan Absensi';
                saveBtn.className = 'flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors';
            }
        }

        function showAttendanceStatus(type, message) {
            const statusDiv = document.getElementById('attendance-status');
            let bgColor, textColor, icon;
            
            switch(type) {
                case 'success':
                    bgColor = 'bg-green-50';
                    textColor = 'text-green-800';
                    icon = '‚úÖ';
                    break;
                case 'info':
                    bgColor = 'bg-blue-50';
                    textColor = 'text-blue-800';
                    icon = '‚ÑπÔ∏è';
                    break;
                case 'warning':
                    bgColor = 'bg-yellow-50';
                    textColor = 'text-yellow-800';
                    icon = '‚ö†Ô∏è';
                    break;
                case 'error':
                    bgColor = 'bg-red-50';
                    textColor = 'text-red-800';
                    icon = '‚ùå';
                    break;
                default:
                    bgColor = 'bg-gray-50';
                    textColor = 'text-gray-800';
                    icon = '‚ÑπÔ∏è';
            }
            
            statusDiv.className = `mb-4 p-3 rounded-lg ${bgColor} ${textColor}`;
            statusDiv.innerHTML = `${icon} ${message}`;
            statusDiv.classList.remove('hidden');
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                statusDiv.classList.add('hidden');
            }, 5000);
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        // Excel upload functions - Enhanced version
        function downloadTemplate() {
            // Always use CSV format for maximum compatibility
            downloadCSVTemplate();
        }

        function downloadCSVTemplate() {
            try {
                // Create CSV content with BOM for proper Excel encoding
                const csvContent = '\uFEFF' + 'NIS,Nama,Kelas\n2024006,Contoh Siswa 1,XII RPL 3\n2024007,Contoh Siswa 2,XII RPL 4\n2024008,Contoh Siswa 3,XI RPL 4\n2024009,Contoh Siswa 4,X RPL 5\n2024010,Contoh Siswa 5,XI LOG';
                
                // Create blob with proper MIME type
                const blob = new Blob([csvContent], { 
                    type: 'text/csv;charset=utf-8;' 
                });
                
                // Create download link
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Template_Data_Siswa.csv';
                
                // Trigger download
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Clean up
                window.URL.revokeObjectURL(url);
                
                // Show success message
                setTimeout(() => {
                    alert('‚úÖ Template berhasil didownload!\n\nFile: "Template_Data_Siswa.csv"\n\nüìã Cara menggunakan:\n1. Buka file dengan Excel/Google Sheets\n2. Isi data siswa sesuai format\n3. Simpan dan upload kembali\n\nüí° Format: NIS, Nama, Kelas');
                }, 300);
                
            } catch (error) {
                console.error('Download error:', error);
                showTemplateModal();
            }
        }

        function showTemplateModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-96 overflow-y-auto">
                    <h3 class="text-lg font-bold mb-4">üìã Template Data Siswa</h3>
                    <div class="bg-gray-100 p-4 rounded-lg mb-4 font-mono text-sm">
                        <div class="mb-2 font-bold">Format CSV:</div>
                        <div>NIS,Nama,Kelas</div>
                        <div>2024006,Contoh Siswa 1,XII RPL 3</div>
                        <div>2024007,Contoh Siswa 2,XII RPL 4</div>
                        <div>2024008,Contoh Siswa 3,XI RPL 4</div>
                        <div>2024009,Contoh Siswa 4,X RPL 5</div>
                        <div>2024010,Contoh Siswa 5,XI LOG</div>
                    </div>
                    <div class="text-sm text-gray-600 mb-4">
                        <p class="mb-2"><strong>üìù Instruksi:</strong></p>
                        <ol class="list-decimal list-inside space-y-1">
                            <li>Copy format di atas ke Excel/Google Sheets</li>
                            <li>Ganti data contoh dengan data siswa sebenarnya</li>
                            <li>Simpan sebagai file CSV atau Excel</li>
                            <li>Upload menggunakan tombol "Upload Excel"</li>
                        </ol>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                        ‚úÖ Mengerti
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            console.log('File selected:', file.name, file.type);

            // Handle CSV files
            if (file.name.toLowerCase().endsWith('.csv') || file.type === 'text/csv') {
                handleCSVFile(file);
                return;
            }

            // Handle Excel files
            if (file.name.toLowerCase().endsWith('.xlsx') || file.name.toLowerCase().endsWith('.xls')) {
                handleExcelFile(file);
                return;
            }

            alert('‚ùå Format file tidak didukung!\n\nGunakan file dengan format:\n‚Ä¢ .csv (Comma Separated Values)\n‚Ä¢ .xlsx (Excel)\n‚Ä¢ .xls (Excel lama)');
        }

        function handleCSVFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csvData = e.target.result;
                    const lines = csvData.split('\n').filter(line => line.trim());
                    
                    if (lines.length < 2) {
                        alert('‚ùå File CSV kosong atau tidak valid!');
                        return;
                    }

                    // Parse CSV
                    const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
                    console.log('CSV Headers:', headers);

                    // Find column indices
                    const nisIndex = headers.findIndex(h => h.toLowerCase().includes('nis'));
                    const nameIndex = headers.findIndex(h => h.toLowerCase().includes('nama') || h.toLowerCase().includes('name'));
                    const classIndex = headers.findIndex(h => h.toLowerCase().includes('kelas') || h.toLowerCase().includes('class'));

                    if (nisIndex === -1 || nameIndex === -1 || classIndex === -1) {
                        alert('‚ùå Format file tidak sesuai!\n\nPastikan file memiliki kolom:\n‚Ä¢ NIS\n‚Ä¢ Nama\n‚Ä¢ Kelas');
                        return;
                    }

                    excelData = [];
                    for (let i = 1; i < lines.length; i++) {
                        const values = lines[i].split(',').map(v => v.trim().replace(/"/g, ''));
                        if (values[nisIndex] && values[nameIndex] && values[classIndex]) {
                            excelData.push({
                                nis: String(values[nisIndex]).trim(),
                                name: String(values[nameIndex]).trim(),
                                class: String(values[classIndex]).trim()
                            });
                        }
                    }

                    if (excelData.length === 0) {
                        alert('‚ùå Tidak ada data valid yang ditemukan!');
                        return;
                    }

                    console.log('Parsed CSV data:', excelData);
                    showPreview();
                    document.getElementById('upload-btn').disabled = false;

                } catch (error) {
                    console.error('CSV parsing error:', error);
                    alert('‚ùå Error membaca file CSV: ' + error.message);
                }
            };
            reader.readAsText(file);
        }

        function handleExcelFile(file) {
            // Check if XLSX library is available
            if (typeof XLSX === 'undefined') {
                alert('‚ùå Library Excel tidak tersedia!\n\nSilakan gunakan file CSV sebagai alternatif.');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

                    if (jsonData.length < 2) {
                        alert('‚ùå File Excel kosong atau tidak valid!');
                        return;
                    }

                    // Process data
                    const headers = jsonData[0];
                    console.log('Excel Headers:', headers);

                    const nisIndex = headers.findIndex(h => h && h.toString().toLowerCase().includes('nis'));
                    const nameIndex = headers.findIndex(h => h && (h.toString().toLowerCase().includes('nama') || h.toString().toLowerCase().includes('name')));
                    const classIndex = headers.findIndex(h => h && (h.toString().toLowerCase().includes('kelas') || h.toString().toLowerCase().includes('class')));

                    if (nisIndex === -1 || nameIndex === -1 || classIndex === -1) {
                        alert('‚ùå Format file tidak sesuai!\n\nPastikan file memiliki kolom:\n‚Ä¢ NIS\n‚Ä¢ Nama\n‚Ä¢ Kelas');
                        return;
                    }

                    excelData = [];
                    for (let i = 1; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        if (row[nisIndex] && row[nameIndex] && row[classIndex]) {
                            excelData.push({
                                nis: String(row[nisIndex]).trim(),
                                name: String(row[nameIndex]).trim(),
                                class: String(row[classIndex]).trim()
                            });
                        }
                    }

                    if (excelData.length === 0) {
                        alert('‚ùå Tidak ada data valid yang ditemukan!');
                        return;
                    }

                    console.log('Parsed Excel data:', excelData);
                    showPreview();
                    document.getElementById('upload-btn').disabled = false;

                } catch (error) {
                    console.error('Excel parsing error:', error);
                    alert('‚ùå Error membaca file Excel: ' + error.message);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function showPreview() {
            const preview = document.getElementById('file-preview');
            const content = document.getElementById('preview-content');
            
            let previewHtml = `<p class="mb-2"><strong>Total data: ${excelData.length} siswa</strong></p>`;
            previewHtml += '<div class="max-h-40 overflow-y-auto">';
            previewHtml += '<table class="w-full text-xs border-collapse border border-gray-300">';
            previewHtml += '<thead><tr class="bg-gray-100"><th class="border border-gray-300 px-2 py-1">NIS</th><th class="border border-gray-300 px-2 py-1">Nama</th><th class="border border-gray-300 px-2 py-1">Kelas</th></tr></thead>';
            previewHtml += '<tbody>';
            
            excelData.slice(0, 10).forEach(student => {
                previewHtml += `<tr><td class="border border-gray-300 px-2 py-1">${student.nis}</td><td class="border border-gray-300 px-2 py-1">${student.name}</td><td class="border border-gray-300 px-2 py-1">${student.class}</td></tr>`;
            });
            
            if (excelData.length > 10) {
                previewHtml += `<tr><td colspan="3" class="border border-gray-300 px-2 py-1 text-center text-gray-500">... dan ${excelData.length - 10} data lainnya</td></tr>`;
            }
            
            previewHtml += '</tbody></table></div>';
            
            content.innerHTML = previewHtml;
            preview.classList.remove('hidden');
        }

        function uploadExcelData() {
            if (excelData.length === 0) {
                alert('Tidak ada data untuk diupload!');
                return;
            }

            let addedCount = 0;
            let duplicateCount = 0;

            excelData.forEach(studentData => {
                // Check for duplicate NIS
                if (students.find(s => s.nis === studentData.nis)) {
                    duplicateCount++;
                } else {
                    const newStudent = {
                        id: Date.now() + Math.random(),
                        nis: studentData.nis,
                        name: studentData.name,
                        class: studentData.class
                    };
                    students.push(newStudent);
                    addedCount++;
                }
            });

            localStorage.setItem('students', JSON.stringify(students));
            renderStudentsTable();
            renderAttendanceList();
            hideUploadForm();

            let message = `Upload selesai!\n`;
            message += `‚úÖ ${addedCount} siswa berhasil ditambahkan\n`;
            if (duplicateCount > 0) {
                message += `‚ö†Ô∏è ${duplicateCount} siswa diabaikan (NIS sudah ada)`;
            }
            
            alert(message);
        }

        // Filter attendance by class
        document.getElementById('class-filter').addEventListener('change', renderAttendanceList);

        // Reports
        function generateReport() {
            const startDate = document.getElementById('report-start-date').value;
            const endDate = document.getElementById('report-end-date').value;
            const classFilter = document.getElementById('report-class-filter').value;

            if (!startDate || !endDate) {
                alert('Pilih rentang tanggal untuk laporan!');
                return;
            }

            const filteredStudents = classFilter ? 
                students.filter(s => s.class === classFilter) : students;

            const reportData = filteredStudents.map(student => {
                let hadir = 0, sakit = 0, izin = 0, alpha = 0, total = 0;

                // Count attendance for date range
                for (let date in attendance) {
                    if (date >= startDate && date <= endDate) {
                        if (attendance[date][student.id]) {
                            total++;
                            switch (attendance[date][student.id]) {
                                case 'hadir': hadir++; break;
                                case 'sakit': sakit++; break;
                                case 'izin': izin++; break;
                                case 'alpha': alpha++; break;
                            }
                        }
                    }
                }

                const percentage = total > 0 ? Math.round((hadir / total) * 100) : 0;

                return {
                    name: student.name,
                    class: student.class,
                    hadir, sakit, izin, alpha,
                    percentage
                };
            });

            renderReportTable(reportData);
            document.getElementById('report-results').classList.remove('hidden');
        }

        function renderReportTable(data) {
            const tbody = document.getElementById('report-table');
            tbody.innerHTML = data.map(row => `
                <tr class="border-b hover:bg-gray-50">
                    <td class="px-4 py-3 text-sm text-gray-900">${row.name}</td>
                    <td class="px-4 py-3 text-sm text-gray-900">${row.class}</td>
                    <td class="px-4 py-3 text-sm text-green-600 font-semibold">${row.hadir}</td>
                    <td class="px-4 py-3 text-sm text-yellow-600 font-semibold">${row.sakit}</td>
                    <td class="px-4 py-3 text-sm text-blue-600 font-semibold">${row.izin}</td>
                    <td class="px-4 py-3 text-sm text-red-600 font-semibold">${row.alpha}</td>
                    <td class="px-4 py-3 text-sm">
                        <span class="px-2 py-1 rounded-full text-xs font-semibold ${
                            row.percentage >= 80 ? 'bg-green-100 text-green-800' :
                            row.percentage >= 60 ? 'bg-yellow-100 text-yellow-800' :
                            'bg-red-100 text-red-800'
                        }">
                            ${row.percentage}%
                        </span>
                    </td>
                </tr>
            `).join('');
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'979a03e6540cfd07',t:'MTc1Njk1MjUwNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
